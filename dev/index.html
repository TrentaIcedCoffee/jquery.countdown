<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"
                integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
                crossorigin="anonymous"></script>
        <title>demo - countdown</title>
    </head>
    <body>
        <div id="wrapper" class="countdown">

        </div>
    </body>
    <script>
        'use strict'

        function divmod(a, b) {
            return [Math.floor(a / b), a % b];
        }

        function Time(time) {
            this.timeObj = time;
        }
        Time.fields = ['days', 'hours', 'minutes', 'seconds'];
        Time.maxDigit = [9, 9, 2, 3, 5, 9, 5, 9];

        function Countdown(time, gap, div, callback) {
            function numArrayOf(time) {
                var numArray = [];
                Time.fields.forEach(function(field) {
                    numArray.push(...divmod(time.timeObj[field], 10));
                });
                return numArray;
            }
            this.time = time;
            this.gap = gap;
            this.numArray = numArrayOf(time);
            $(div).html(
                '<span style=''>\

                </span>'
            );
            var numArrayHandler = this.numArray;
            var tickHandler = function() {
                var isEnd = false;
                function moveOf(pos, toDigit) {
                    return {pos: pos, toDigit: toDigit};
                }
                function tickHelper(pos) {
                    if (numArrayHandler[pos] == 0) {
                        numArrayHandler[pos] = Time.maxDigit[pos];
                        moves.push(moveOf(pos, Time.maxDigit[pos]));
                        if (pos == 0) {
                            isEnd = true;
                            return; // 0 -> max
                        }
                        tickHelper(pos - 1);
                    } else {
                        numArrayHandler[pos] -= 1;
                        moves.push(moveOf(pos, numArrayHandler[pos] - 1));
                    }
                }
                var moves = [];
                tickHelper(7);
                if (isEnd) {
                    console.log('STOP');
                    return;
                }
                console.log(numArrayHandler.join(''));
                // render moves
                setTimeout(tickHandler, gap);
            };
            this.tick = tickHandler;
        }

        function debug() {
            var div = $('#wrapper');
            var start = {days: 0, hours: 0, minutes: 0, seconds: 2};
            var countdown = new Countdown(new Time(start), 1000, div, function() {
                console.log('STOP');
            });
            countdown.tick();
        }
    </script>
</html>
